{"ast":null,"code":"var _jsxFileName = \"/Users/aqilaataa/Documents/CalculatoeMobile/contexts/AuthContext.tsx\";\nimport React, { createContext, useState, useEffect, useContext } from 'react';\nimport { auth, db } from '../firebaseConfig';\nimport { onAuthStateChanged } from 'firebase/auth';\nimport { doc, getDoc, setDoc, serverTimestamp } from 'firebase/firestore';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = createContext({\n  user: null,\n  loading: true\n});\nexport const useAuth = () => useContext(AuthContext);\nexport const AuthProvider = ({\n  children\n}) => {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async user => {\n      setUser(user);\n      if (user) {\n        const userRef = doc(db, 'users', user.uid);\n        const userDoc = await getDoc(userRef);\n        if (!userDoc.exists()) {\n          await setDoc(userRef, {\n            email: user.email,\n            createdAt: serverTimestamp()\n          });\n        }\n        const statsRef = doc(db, 'playerStats', user.uid);\n        const statsDoc = await getDoc(statsRef);\n        if (!statsDoc.exists()) {\n          await setDoc(statsRef, {\n            easy: 0,\n            medium: 0,\n            hard: 0,\n            total: 0\n          });\n        }\n      }\n      setLoading(false);\n    });\n    return unsubscribe;\n  }, []);\n  return _jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      loading\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 58,\n    columnNumber: 5\n  }, this);\n};","map":{"version":3,"names":["React","createContext","useState","useEffect","useContext","auth","db","onAuthStateChanged","doc","getDoc","setDoc","serverTimestamp","jsxDEV","_jsxDEV","AuthContext","user","loading","useAuth","AuthProvider","children","setUser","setLoading","unsubscribe","userRef","uid","userDoc","exists","email","createdAt","statsRef","statsDoc","easy","medium","hard","total","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["/Users/aqilaataa/Documents/CalculatoeMobile/contexts/AuthContext.tsx"],"sourcesContent":["import React, { createContext, useState, useEffect, useContext } from 'react';\nimport { auth, db } from '../firebaseConfig';\nimport { onAuthStateChanged, User } from 'firebase/auth';\nimport { doc, getDoc, setDoc, serverTimestamp } from 'firebase/firestore';\n\ninterface AuthContextType {\n  user: User | null;\n  loading: boolean;\n}\n\nconst AuthContext = createContext<AuthContextType>({ user: null, loading: true });\n\nexport const useAuth = () => useContext(AuthContext);\n\ninterface AuthProviderProps {\n  children: React.ReactNode;\n}\n\nexport const AuthProvider: React.FC<AuthProviderProps> = ({ children }) => {\n  const [user, setUser] = useState<User | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async (user) => {\n      setUser(user);\n      if (user) {\n        // Check if user document exists in 'users' collection\n        const userRef = doc(db, 'users', user.uid);\n        const userDoc = await getDoc(userRef);\n        if (!userDoc.exists()) {\n          // If not, create a new document\n          await setDoc(userRef, {\n            email: user.email,\n            createdAt: serverTimestamp(),\n          });\n        }\n\n        // Check if stats document exists in 'playerStats' collection\n        const statsRef = doc(db, 'playerStats', user.uid);\n        const statsDoc = await getDoc(statsRef);\n        if (!statsDoc.exists()) {\n          // If not, create a new document with initial stats\n          await setDoc(statsRef, {\n            easy: 0,\n            medium: 0,\n            hard: 0,\n            total: 0\n          });\n        }\n      }\n      setLoading(false);\n    });\n\n    return unsubscribe;\n  }, []);\n\n  return (\n    <AuthContext.Provider value={{ user, loading }}>\n      {children}\n    </AuthContext.Provider>\n  );\n};"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,aAAa,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,UAAU,QAAQ,OAAO;AAC7E,SAASC,IAAI,EAAEC,EAAE,QAAQ,mBAAmB;AAC5C,SAASC,kBAAkB,QAAc,eAAe;AACxD,SAASC,GAAG,EAAEC,MAAM,EAAEC,MAAM,EAAEC,eAAe,QAAQ,oBAAoB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAO1E,MAAMC,WAAW,GAAGb,aAAa,CAAkB;EAAEc,IAAI,EAAE,IAAI;EAAEC,OAAO,EAAE;AAAK,CAAC,CAAC;AAEjF,OAAO,MAAMC,OAAO,GAAGA,CAAA,KAAMb,UAAU,CAACU,WAAW,CAAC;AAMpD,OAAO,MAAMI,YAAyC,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EACzE,MAAM,CAACJ,IAAI,EAAEK,OAAO,CAAC,GAAGlB,QAAQ,CAAc,IAAI,CAAC;EACnD,MAAM,CAACc,OAAO,EAAEK,UAAU,CAAC,GAAGnB,QAAQ,CAAC,IAAI,CAAC;EAE5CC,SAAS,CAAC,MAAM;IACd,MAAMmB,WAAW,GAAGf,kBAAkB,CAACF,IAAI,EAAE,MAAOU,IAAI,IAAK;MAC3DK,OAAO,CAACL,IAAI,CAAC;MACb,IAAIA,IAAI,EAAE;QAER,MAAMQ,OAAO,GAAGf,GAAG,CAACF,EAAE,EAAE,OAAO,EAAES,IAAI,CAACS,GAAG,CAAC;QAC1C,MAAMC,OAAO,GAAG,MAAMhB,MAAM,CAACc,OAAO,CAAC;QACrC,IAAI,CAACE,OAAO,CAACC,MAAM,CAAC,CAAC,EAAE;UAErB,MAAMhB,MAAM,CAACa,OAAO,EAAE;YACpBI,KAAK,EAAEZ,IAAI,CAACY,KAAK;YACjBC,SAAS,EAAEjB,eAAe,CAAC;UAC7B,CAAC,CAAC;QACJ;QAGA,MAAMkB,QAAQ,GAAGrB,GAAG,CAACF,EAAE,EAAE,aAAa,EAAES,IAAI,CAACS,GAAG,CAAC;QACjD,MAAMM,QAAQ,GAAG,MAAMrB,MAAM,CAACoB,QAAQ,CAAC;QACvC,IAAI,CAACC,QAAQ,CAACJ,MAAM,CAAC,CAAC,EAAE;UAEtB,MAAMhB,MAAM,CAACmB,QAAQ,EAAE;YACrBE,IAAI,EAAE,CAAC;YACPC,MAAM,EAAE,CAAC;YACTC,IAAI,EAAE,CAAC;YACPC,KAAK,EAAE;UACT,CAAC,CAAC;QACJ;MACF;MACAb,UAAU,CAAC,KAAK,CAAC;IACnB,CAAC,CAAC;IAEF,OAAOC,WAAW;EACpB,CAAC,EAAE,EAAE,CAAC;EAEN,OACET,OAAA,CAACC,WAAW,CAACqB,QAAQ;IAACC,KAAK,EAAE;MAAErB,IAAI;MAAEC;IAAQ,CAAE;IAAAG,QAAA,EAC5CA;EAAQ;IAAAkB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACW,CAAC;AAE3B,CAAC","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}